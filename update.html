// This update page will only work for versions 0.1.2+.

(async () => {
  let fixedadminejs = await fetch(
    "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/themes/default/admin.ejs",
    {
        method: "get"
    }
  );
  (async () => {
    fs.writeFile(`./themes/default/admin.ejs`, await fixedadminejs.text(), (err) => { 
      if (err) { 
        console.log(err); 
      };
      if (newsettings.version !== "0.1.2-themes5") {
        (async () => {
          let thenewindexjs = await fetch(
            "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/index.js",
             {
                method: "get"
             }
          );
          fs.writeFile(`./index.js`, await thenewindexjs.text(), (err) => { 
            if (err) { 
              console.log(err); 
            };
            (async () => {
              if (newsettings.version == "0.1.2-themes4") {
                newsettings.version = "0.1.2-themes6";
                fs.writeFile(`./settings.json`, JSON.stringify(newsettings, 0, 2), (err) => { 
                  if (err) { 
                    console.log(err); 
                  };
                  process.exit();
                });
                return;
              }
              let newapipagesjs = await fetch(
                "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/api/pages.js",
                 {
                    method: "get"
                 }
              );
              fs.writeFile(`./api/pages.js`, await newapipagesjs.text(), (err) => { 
                  if (err) { 
                    console.log(err); 
                  };
                  if (newsettings.version == "0.1.2-themes3") {
                    newsettings.version = "0.1.2-themes6";
                    fs.writeFile(`./settings.json`, JSON.stringify(newsettings, 0, 2), (err) => { 
                      if (err) { 
                        console.log(err); 
                      };
                      process.exit();
                    });
                    return;
                  } else {
                    (async () => {
                      let fixeddashboardejs = await fetch(
                          "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/themes/default/dashboard.ejs",
                          {
                              method: "get"
                          }
                      );
                      fs.writeFile(`./themes/default/dashboard.ejs`, await fixeddashboardejs.text(), (err) => {
                          if (err) {
                              console.log(err);
                          };
                          (async () => {
                              let fixedindexejs = await fetch(
                                  "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/themes/default/index.ejs",
                                  {
                                      method: "get"
                                  }
                              );
                              fs.writeFile(`./themes/default/index.ejs`, await fixedindexejs.text(), (err) => {
                                  if (err) {
                                      console.log(err);
                                  };
                                  fs.mkdir("./themes/light", (err) => {
                                      if (err) { 
                                          console.log(err); 
                                      };
                                      fs.mkdir("./assets/light", (err) => { 
                                          if (err) { 
                                              console.log(err); 
                                          };
                                          (async () => {
                                              let lightthemestyle = await fetch(
                                                  "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/assets/light/style.css",
                                                  {
                                                      method: "get"
                                                  }
                                              );
                                              fs.writeFile(`./assets/light/style.css`, await lightthemestyle.text(), (err) => {
                                                  if (err) { 
                                                      console.log(err); 
                                                  };
                                                  (async () => {
                                                      let themefiles = fs.readdirSync('./themes/default');
                                                      for (let i = 0, len = themefiles.length; i < len; i++) {
                                                          let lightthemefile = await fetch(
                                                              "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/themes/light/" + themefiles[i],
                                                              {
                                                                  method: "get"
                                                              }
                                                          );
                                                          fs.writeFile(`./themes/light/${themefiles[i]}`, await lightthemefile.text(), (err) => {
                                                              if (err) {
                                                                  console.log(err);
                                                              };
                                                          });
                                                          if (i == themefiles.length - 1) {
                                                              newsettings.version = "0.1.2-themes6";
                                                              fs.writeFile(`./settings.json`, JSON.stringify(newsettings, 0, 2), (err) => { 
                                                                  if (err) { 
                                                                      console.log(err); 
                                                                  };
                                                                  process.exit();
                                                              });
                                                          }
                                                      }
                                                  })();
                                              });
                                          })();
                                      });
                                  });
                              });
                         })();
                      });
                    })();
                  }
                });    
            })();
          });
        })();
      } else {
        (async () => {
          let fixedlightadminejs = await fetch(
            "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes6/themes/light/admin.ejs",
            {
                method: "get"
            }
          );
          fs.writeFile(`./themes/light/admin.ejs`, await fixedlightadminejs.text(), (err) => {
            if (err) { 
              console.log(err); 
            };
            newsettings.version = "0.1.2-themes6";
            fs.writeFile(`./settings.json`, JSON.stringify(newsettings, 0, 2), (err) => { 
              if (err) { 
                console.log(err); 
              };
              process.exit();
            });
          });
        })();
      }
    });
  })();
})();
