// This update page will only work for versions 0.1.2+.

// I TOOK AROUND 2-3 HOUR ON MAKING THIS!!!

(async () => {
    let fixeddashboardejs = await fetch(
        "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes3/themes/default/dashboard.ejs",
        {
            method: "get"
        }
    );
    fs.writeFile(`./themes/default/dashboard.ejs`, await fixeddashboardejs.text(), (err) => {
        if (err) {
            console.log(err);
        };
        (async () => {
            let fixedindexejs = await fetch(
                "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes3/themes/default/index.ejs",
                {
                    method: "get"
                }
            );
            fs.writeFile(`./themes/default/index.ejs`, await fixedindexejs.text(), (err) => {
                if (err) {
                    console.log(err);
                };
                fs.mkdir("./themes/light", (err) => {
                    if (err) { 
                        console.log(err); 
                    };
                    fs.mkdir("./assets/light", (err) => { 
                        if (err) { 
                            console.log(err); 
                        };
                        (async () => {
                            let lightthemestyle = await fetch(
                                "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes3/assets/light/style.css",
                                {
                                    method: "get"
                                }
                            );
                            fs.writeFile(`./assets/light/style.css`, await lightthemestyle.text(), (err) => {
                                if (err) { 
                                    console.log(err); 
                                };
                                (async () => {
                                    let themefiles = fs.readdirSync('./themes/default');
                                    for (let i = 0, len = themefiles.length; i < len; i++) {
                                        let lightthemefile = await fetch(
                                            "https://raw.githubusercontent.com/real2two/dashactyl/0.1.2-themes3/themes/light/" + themefiles[i],
                                            {
                                                method: "get"
                                            }
                                        );
                                        fs.writeFile(`./themes/light/${themefiles[i]}`, await lightthemefile.text(), (err) => {
                                            if (err) {
                                                console.log(err);
                                            };
                                        });
                                        if (i == themefiles.length - 1) {
                                            newsettings.version = "0.1.2-themes3";
                                            fs.writeFile(`./settings.json`, JSON.stringify(newsettings, 0, 2), (err) => { 
                                                if (err) { 
                                                    console.log(err); 
                                                };
                                                process.exit();
                                            });
                                        }
                                    }
                                })();
                            });
                        })();
                    });
                });
            });
       })();
    });
})();
